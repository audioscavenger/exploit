(($# < 1 )) && echo2 "${C}${FUNCNAME}${c} [/var/log/messages]${END}" && exit 99

if [ -n "$1" ]; then
  messages=$1
else
  [ -n /var/log/messages ] && messages=/var/log/messages
  [ -n /var/log/syslog ] && messages=/var/log/syslog
fi

if [ "${messages%nginx*}" -ne "${messages}" ]; then
  # this is an nginx log, we are looking for pattern=client: 2602:47:df68:8900:34b9:f357:26bf:8122,
  grep -shoP '(?<=client: )[^,]*' $messages | sort | uniq >/tmp/listHackers.log
else
  # this is a system log
  awk '/password/ {print $NF}' $messages | cut -f1 -d: | sort | uniq >/tmp/listHackers.log
fi





# now analyze each IP address:
wwhois /tmp/listHackers.log

