#!/usr/bin/env bash
# this will nslookup all the free domains of n chars in .ext (com by default)

num=5
ext=com

(($# < 1 )) && echo2 "${C}$(basename $0)${c} <n> [ext]${END}" && exit 99
(($# > 0 )) && set num=$1
(($# > 1 )) && set ext=$2

alphabet=abcdefghijklmnopqrstuvwxyz
pointer=/tmp/$(basename $0).lock
results=/tmp/$(basename $0).free.com
# echo axyaa >${pointer}

# get current position:
[ -s ${pointer} ] && read position <${pointer}
[ ! -n "${position}" ] && position=$(echo ${alphabet:0:num} | sed "s/./a/g")

# reassign starting variables:
for i in $(seq 1 ${#position}); do
  echo ${alphabet:i-1:1}=${position:i-1:1}
  eval ${alphabet:i-1:1}=${position:i-1:1}
done

echo starting with ${position}
echo -ne press ENTER to start...
read
for A in $(eval echo {$a..z}); do
  echo doing $A$B$C$D$E.${ext} ...
  for B in $(eval echo {$b..z}); do
    echo doing $A$B$C$D$E.${ext} ...
    for C in $(eval echo {$c..z}); do
      echo doing $A$B$C$D$E.${ext} ...
      for D in $(eval echo {$d..z}); do
        echo doing $A$B$C$D$E.${ext} ...
        for E in $(eval echo {$e..z}); do
          echo doing $A$B$C$D$E.${ext} ...
          # nslookup $A$B$C$D$E.com | grep -q NXDOMAIN && echo $A$B$C$D$E >>${results}
          dig $A$B$C$D$E.com +short | grep -q . || echo $A$B$C$D$E >>${results}
        done
        read
        # save position every 26 domains:
        echo $A$B$C$D$E >${pointer}
      done
      # save position every 676 domains:
      # echo $A$B$C$D$E >${pointer}
    done
  done
done
